from urllib.parse import urlencodeimport requests#定义URL的前半部分base_url = 'https://m.weibo.cn/api/container/getIndex?'#构造请求头部headers = {    'Host':'m.weibo.cn',    'Referer':'https://m.weibo.cn/u/5312782088',    'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/52.0.2743.116 Safari/537.36',    'X-Requested-With':'XMLHttpRequest',}def get_page(page):    #构造参数字典    params = {        'type':'uid',        'value':'5312782088',        'containerid':'1076035312782088',        'page':page    }    #整合为完整的URL    url = base_url + urlencode(params)    try:        #使用requests请求这个链接        response = requests.get(url,headers=headers)        if response.status_code == 200:            return response.json()    except requests.ConnectionError as e:        print('Error',e.args)#定义解析方法from pyquery import PyQuery as pqdef parse_page(json):    if json:        items = json.get('data').get('cards')        for item in items:            item = item.get('mblog')            weibo = {}            weibo['id']=item.get('id')            weibo['text'] = pq(item.get('text')).text()            weibo['attitudes'] = item.get('attitudes_count')            weibo['comments']=item.get('comments_count')            weibo['reposts'] = item.get('reposts_count')            yield weiboif __name__ == '__main__':    for page in range(1,20):        json = get_page(page)        results = parse_page(json)        for result in results:            print(result)